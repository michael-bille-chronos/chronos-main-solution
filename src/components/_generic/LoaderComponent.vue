<template>
  <div :class="['loader', full ? 'loader--full' : 'loader--simple']">
    <svg class="loader__svg" width="304" height="242" viewBox="0 0 304 242" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <path
        class="logo-letter"
        d="M91 124.184C91 122.192 91.1825 120.77 91.5475 119.918C91.8943 119.104 92.3874 118.394 93.0267 117.788C93.6479 117.199 94.367 116.744 95.1828 116.422C96.0094 116.1 96.8808 115.94 97.7968 115.94C98.412 115.94 98.9945 116.003 99.547 116.129C99.7561 116.178 99.9519 116.232 100.135 116.294C100.274 116.341 100.387 116.386 100.474 116.427V118.968C100.277 118.876 100.002 118.796 99.6507 118.727C99.1407 118.621 98.5234 118.568 97.7968 118.568C96.5919 118.568 95.5804 118.948 94.761 119.707C93.9307 120.481 93.5162 121.973 93.5162 124.184C93.5162 126.395 93.9307 127.885 94.761 128.655C95.5804 129.415 96.5919 129.795 97.7968 129.795C98.5234 129.795 99.1407 129.744 99.6507 129.641C99.8564 129.6 100.045 129.551 100.219 129.492C100.35 129.448 100.437 129.415 100.474 129.395V131.935C100.384 131.977 100.271 132.023 100.135 132.074C99.9519 132.132 99.7561 132.188 99.547 132.238C98.9945 132.365 98.412 132.429 97.7968 132.429C96.8808 132.429 96.0094 132.268 95.1828 131.946C94.367 131.624 93.6479 131.168 93.0267 130.575C92.3874 129.973 91.8943 129.265 91.5475 128.45C91.1825 127.598 91 126.176 91 124.184Z"
      />
      <path
        class="logo-letter"
        d="M107.458 120.421C109.17 120.421 110.492 120.834 111.422 121.659C112.388 122.514 112.87 123.784 112.87 125.467V132.192H110.391V125.673C110.391 124.509 110.102 123.727 109.526 123.327C109.127 123.053 108.438 122.916 107.458 122.916C106.601 122.916 105.792 123.154 105.031 123.63V132.192H102.557V115H105.031V121.083C105.75 120.642 106.559 120.421 107.458 120.421Z"
      />
      <path
        class="logo-letter"
        d="M117.427 132.203H114.953V121.689C115.626 121.223 116.418 120.881 117.328 120.663C118.869 120.293 120.49 120.332 122.188 120.78V123.193C121.281 122.878 120.404 122.719 119.557 122.716C118.772 122.712 118.062 122.856 117.427 123.147V132.203"
      />
      <path
        class="logo-letter"
        d="M125.438 126.422C125.438 127.87 125.776 128.869 126.454 129.421C127.051 129.903 127.767 130.144 128.604 130.144C129.514 130.144 130.262 129.876 130.849 129.338C131.467 128.777 131.776 127.805 131.776 126.422C131.776 125.04 131.467 124.069 130.849 123.511C130.262 122.971 129.514 122.7 128.604 122.7C127.767 122.7 127.051 122.941 126.454 123.424C125.776 123.975 125.438 124.975 125.438 126.422V126.422ZM128.604 132.429C127.82 132.429 127.079 132.292 126.38 132.018C125.711 131.758 125.122 131.386 124.614 130.904C124.118 130.425 123.736 129.872 123.469 129.246C123.195 128.602 123.058 127.662 123.058 126.422C123.058 125.183 123.195 124.243 123.469 123.599C123.736 122.972 124.118 122.42 124.614 121.941C125.684 120.924 127.014 120.416 128.604 120.416C129.389 120.416 130.13 120.553 130.829 120.826C131.502 121.087 132.079 121.449 132.563 121.915C133.08 122.411 133.472 122.972 133.74 123.599C134.014 124.243 134.151 125.183 134.151 126.422C134.151 127.662 134.014 128.602 133.74 129.246C133.472 129.872 133.08 130.433 132.563 130.929C131.518 131.929 130.198 132.429 128.604 132.429Z"
      />
      <path
        class="logo-letter"
        d="M143.546 125.463C143.546 124.302 143.258 123.52 142.682 123.116C142.279 122.842 141.589 122.706 140.614 122.706C140.129 122.706 139.672 122.77 139.245 122.901C139.08 122.949 138.9 123.015 138.702 123.101L138.432 123.214L138.187 123.321V132.182H135.714V121.792C137.23 120.878 138.864 120.421 140.614 120.421C142.323 120.421 143.642 120.832 144.572 121.653C145.541 122.512 146.026 123.782 146.026 125.463V132.182H143.546V125.463Z"
      />
      <path
        class="logo-letter"
        d="M149.968 126.422C149.968 127.87 150.307 128.869 150.985 129.421C151.582 129.903 152.298 130.144 153.135 130.144C154.045 130.144 154.793 129.876 155.38 129.338C155.998 128.777 156.307 127.805 156.307 126.422C156.307 125.04 155.998 124.069 155.38 123.511C154.793 122.971 154.045 122.7 153.135 122.7C152.298 122.7 151.582 122.941 150.985 123.424C150.307 123.975 149.968 124.975 149.968 126.422V126.422ZM153.135 132.429C152.35 132.429 151.609 132.292 150.911 132.018C150.241 131.758 149.653 131.386 149.145 130.904C148.649 130.425 148.267 129.872 148 129.246C147.725 128.602 147.589 127.662 147.589 126.422C147.589 125.183 147.725 124.243 148 123.599C148.267 122.972 148.649 122.42 149.145 121.941C150.215 120.924 151.545 120.416 153.135 120.416C153.92 120.416 154.661 120.553 155.36 120.826C156.033 121.087 156.61 121.449 157.094 121.915C157.611 122.411 158.002 122.972 158.271 123.599C158.545 124.243 158.682 125.183 158.682 126.422C158.682 127.662 158.545 128.602 158.271 129.246C158.002 129.872 157.611 130.433 157.094 130.929C156.048 131.929 154.729 132.429 153.135 132.429"
      />
      <path
        class="logo-letter"
        d="M161.37 129.143C162.56 129.728 163.498 130.021 164.182 130.021C165.144 130.021 165.625 129.73 165.625 129.148C165.625 128.844 165.45 128.549 165.099 128.265C164.825 128.043 164.313 127.738 163.562 127.351C163.326 127.228 163.003 127.066 162.596 126.864C162.188 126.662 161.929 126.533 161.818 126.479C161.262 126.191 160.861 125.935 160.614 125.709C160.021 125.154 159.724 124.499 159.724 123.743C159.724 122.87 160.045 122.124 160.687 121.504C161.434 120.775 162.467 120.411 163.787 120.411C164.953 120.411 166.167 120.719 167.427 121.335L166.219 123.358C166.063 123.251 165.844 123.144 165.562 123.034C165 122.822 164.408 122.716 163.787 122.716C162.898 122.716 162.453 123.005 162.453 123.583C162.453 123.854 162.706 124.14 163.214 124.441C163.598 124.667 164.333 125.009 165.417 125.467C166.402 125.889 167.133 126.375 167.61 126.926C168.123 127.521 168.38 128.238 168.38 129.076C168.38 130.018 167.975 130.813 167.161 131.464C166.353 132.114 165.272 132.439 163.922 132.439C162.567 132.439 161.22 131.966 159.88 131.022L161.37 129.143"
      />
      <path class="logo-letter" d="M179.549 123.332H171.735V116.39H170.375V132.175H171.735V124.598H179.549V132.175H180.914V116.39H179.549V123.332Z" />
      <path
        class="logo-letter"
        d="M191.908 130.441L190.954 130.851C190.713 130.951 190.499 131.027 190.305 131.085C189.793 131.241 189.236 131.32 188.654 131.32C187.461 131.32 186.616 131.139 186.072 130.766C185.267 130.207 184.862 129.181 184.862 127.715V121.297H183.536V127.715C183.536 129.33 183.969 130.5 184.86 131.289C185.724 132.055 187.001 132.444 188.654 132.444C190.27 132.444 191.807 132.044 193.228 131.255V121.297H191.908V130.441Z"
      />
      <path
        class="logo-letter"
        d="M203.604 130.253C202.915 130.953 202.04 131.309 201.004 131.309C199.646 131.309 198.509 131.003 197.622 130.399L197.333 130.203V123.569L197.59 123.371C198.195 122.9 198.685 122.59 199.087 122.419C199.619 122.191 200.265 122.076 201.004 122.076C202.04 122.076 202.915 122.431 203.605 123.133C204.324 123.861 204.674 125.025 204.674 126.692C204.674 128.36 204.324 129.524 203.604 130.253ZM204.603 122.381C204.153 121.929 203.625 121.578 203.029 121.337C202.398 121.077 201.717 120.946 201.004 120.946C199.964 120.946 199.072 121.182 198.353 121.647L197.333 122.306V115.129H196.007V130.893C196.608 131.345 197.301 131.707 198.074 131.969C198.988 132.28 199.973 132.438 201.004 132.438C201.718 132.438 202.4 132.308 203.031 132.054C203.623 131.806 204.154 131.452 204.603 131.003C205.046 130.56 205.392 130.039 205.632 129.454C205.8 129.042 206 128.122 206 126.089C206 124.534 205.543 123.321 204.603 122.381"
      />
      <g v-if="full">
        <path class="connector connector3" d="M280.5 210C282.433 210 284 208.433 284 206.5C284 204.567 282.433 203 280.5 203C278.567 203 277 204.567 277 206.5C277 208.433 278.567 210 280.5 210Z" />
        <path class="connector connector3" d="M299.5 173C301.433 173 303 171.433 303 169.5C303 167.567 301.433 166 299.5 166C297.567 166 296 167.567 296 169.5C296 171.433 297.567 173 299.5 173Z" />
        <path class="connector connector3" d="M240.5 75C242.433 75 244 73.433 244 71.5C244 69.567 242.433 68 240.5 68C238.567 68 237 69.567 237 71.5C237 73.433 238.567 75 240.5 75Z" />
        <path class="connector connector3" d="M211.5 41C213.433 41 215 39.433 215 37.5C215 35.567 213.433 34 211.5 34C209.567 34 208 35.567 208 37.5C208 39.433 209.567 41 211.5 41Z" />
        <path class="connector connector3" d="M286.5 86C288.433 86 290 84.433 290 82.5C290 80.567 288.433 79 286.5 79C284.567 79 283 80.567 283 82.5C283 84.433 284.567 86 286.5 86Z" />
        <path class="connector connector3" d="M284.5 147C286.433 147 288 145.433 288 143.5C288 141.567 286.433 140 284.5 140C282.567 140 281 141.567 281 143.5C281 145.433 282.567 147 284.5 147Z" />
        <path class="connector connector3" d="M143.5 14C145.433 14 147 12.433 147 10.5C147 8.567 145.433 7 143.5 7C141.567 7 140 8.567 140 10.5C140 12.433 141.567 14 143.5 14Z" />
        <path class="connector connector3" d="M5.5 208C7.433 208 9 206.433 9 204.5C9 202.567 7.433 201 5.5 201C3.567 201 2 202.567 2 204.5C2 206.433 3.567 208 5.5 208Z" />
        <path class="connector connector3" d="M68.5 219C70.433 219 72 217.433 72 215.5C72 213.567 70.433 212 68.5 212C66.567 212 65 213.567 65 215.5C65 217.433 66.567 219 68.5 219Z" />
        <path class="connector connector3" d="M220.5 241C222.433 241 224 239.433 224 237.5C224 235.567 222.433 234 220.5 234C218.567 234 217 235.567 217 237.5C217 239.433 218.567 241 220.5 241Z" />
        <path class="connector connector3" d="M108.5 221C110.433 221 112 219.433 112 217.5C112 215.567 110.433 214 108.5 214C106.567 214 105 215.567 105 217.5C105 219.433 106.567 221 108.5 221Z" />
        <path class="connector connector3" d="M64.5 86C66.433 86 68 84.433 68 82.5C68 80.567 66.433 79 64.5 79C62.567 79 61 80.567 61 82.5C61 84.433 62.567 86 64.5 86Z" />
        <path class="connector connector3" d="M28.5 108C30.433 108 32 106.433 32 104.5C32 102.567 30.433 101 28.5 101C26.567 101 25 102.567 25 104.5C25 106.433 26.567 108 28.5 108Z" />
        <path class="connector connector3" d="M78.5 30C80.433 30 82 28.433 82 26.5C82 24.567 80.433 23 78.5 23C76.567 23 75 24.567 75 26.5C75 28.433 76.567 30 78.5 30Z" />
        <path class="connector connector3" d="M119.5 8C121.433 8 123 6.433 123 4.5C123 2.567 121.433 1 119.5 1C117.567 1 116 2.567 116 4.5C116 6.433 117.567 8 119.5 8Z" />
        <path class="connector connector3" d="M174.5 12C176.433 12 178 10.433 178 8.5C178 6.567 176.433 5 174.5 5C172.567 5 171 6.567 171 8.5C171 10.433 172.567 12 174.5 12Z" />

        <path class="line line3" d="M251.999 111L283.999 84.9995" />
        <path class="line line3" d="M237.291 97.0391L239.999 74.9995" />
        <path class="line line3" d="M185.576 72.0393L209.999 40.9997" />
        <path class="line line3" d="M162.328 28.0393L172.856 11.9997" />
        <path class="line line3" d="M157.999 27.9998L145.999 13.4351" />
        <path class="line line3" d="M100.999 48.0645L80.9993 28.9999" />
        <path class="line line3" d="M79.9999 90.6925L67.9998 84" />
        <path class="line line3" d="M50 125.386L30.9999 107" />
        <path class="line line3" d="M83.8794 89.8532L102 52.9999" />
        <path class="line line3" d="M119.985 24.5669L119.999 7.99986" />
        <path class="line line3" d="M250.999 114.836L281.999 141" />
        <path class="line line3" d="M247.446 109.623L238.999 103" />
        <path class="line line3" d="M26.7837 174L6.78367 201.614" />
        <path class="line line3" d="M99.857 192L107 214" />
        <path class="line line3" d="M271.696 181L278.839 203" />
        <path class="line line3" d="M207.696 221L218 235" />
        <path class="line line3" d="M274 176.652L296.151 169.993" />
        <path class="line line3" d="M146.696 205L203 217" />
        <path class="line line3" d="M95.4259 192L70.6422 213" />
        <path class="line line3" d="M32.0001 172.777L56.0001 181" />

        <path class="connector connector2" d="M206 221.5C207.933 221.5 209.5 219.933 209.5 218C209.5 216.067 207.933 214.5 206 214.5C204.067 214.5 202.5 216.067 202.5 218C202.5 219.933 204.067 221.5 206 221.5Z" />
        <path class="connector connector2" d="M98.5 193C100.433 193 102 191.433 102 189.5C102 187.567 100.433 186 98.5 186C96.567 186 95 187.567 95 189.5C95 191.433 96.567 193 98.5 193Z" />
        <path class="connector connector2" d="M144.5 207C146.433 207 148 205.433 148 203.5C148 201.567 146.433 200 144.5 200C142.567 200 141 201.567 141 203.5C141 205.433 142.567 207 144.5 207Z" />
        <path class="connector connector2" d="M29 174.5C30.933 174.5 32.5 172.933 32.5 171C32.5 169.067 30.933 167.5 29 167.5C27.067 167.5 25.5 169.067 25.5 171C25.5 172.933 27.067 174.5 29 174.5Z" />
        <path class="connector connector2" d="M59.5 185C61.433 185 63 183.433 63 181.5C63 179.567 61.433 178 59.5 178C57.567 178 56 179.567 56 181.5C56 183.433 57.567 185 59.5 185Z" />
        <path class="connector connector2" d="M120.5 31C122.433 31 124 29.433 124 27.5C124 25.567 122.433 24 120.5 24C118.567 24 117 25.567 117 27.5C117 29.433 118.567 31 120.5 31Z" />
        <path class="connector connector2" d="M160.5 34C162.433 34 164 32.433 164 30.5C164 28.567 162.433 27 160.5 27C158.567 27 157 28.567 157 30.5C157 32.433 158.567 34 160.5 34Z" />
        <path class="connector connector2" d="M249.5 116C251.433 116 253 114.433 253 112.5C253 110.567 251.433 109 249.5 109C247.567 109 246 110.567 246 112.5C246 114.433 247.567 116 249.5 116Z" />
        <path class="connector connector2" d="M270.5 181C272.433 181 274 179.433 274 177.5C274 175.567 272.433 174 270.5 174C268.567 174 267 175.567 267 177.5C267 179.433 268.567 181 270.5 181Z" />
        <path class="connector connector2" d="M236.5 104C238.433 104 240 102.433 240 100.5C240 98.567 238.433 97 236.5 97C234.567 97 233 98.567 233 100.5C233 102.433 234.567 104 236.5 104Z" />

        <path class="line line2" d="M187 75L233 99" />
        <path class="line line2" d="M182.613 71.6513L161.613 34" />
        <path class="line line2" d="M80 95L53 123" />
        <path class="line line2" d="M206.562 150L206.5 214.999" />
        <path class="line line2" d="M209.027 148L267.637 176.102" />
        <path class="line line2" d="M130 180L102 188" />
        <path class="line line2" d="M135 182.138L143 200" />
        <path class="line line2" d="M52.7809 129L59 178" />
        <path class="line line2" d="M49.4537 127.21L30.4536 168.21" />
        <path class="line line2" d="M105 47.1281L117.98 30.0567" />
        <path class="line line2" d="M209 145L247 115" />

        <path class="connector connector1" d="M103.5 53C105.433 53 107 51.433 107 49.5C107 47.567 105.433 46 103.5 46C101.567 46 100 47.567 100 49.5C100 51.433 101.567 53 103.5 53Z" />
        <path class="connector connector1" d="M51 129.5C52.933 129.5 54.5 127.933 54.5 126C54.5 124.067 52.933 122.5 51 122.5C49.067 122.5 47.5 124.067 47.5 126C47.5 127.933 49.067 129.5 51 129.5Z" />
        <path class="connector connector1" d="M133.5 182C135.433 182 137 180.433 137 178.5C137 176.567 135.433 175 133.5 175C131.567 175 130 176.567 130 178.5C130 180.433 131.567 182 133.5 182Z" />
        <path class="connector connector1" d="M206 150.5C207.933 150.5 209.5 148.933 209.5 147C209.5 145.067 207.933 143.5 206 143.5C204.067 143.5 202.5 145.067 202.5 147C202.5 148.933 204.067 150.5 206 150.5Z" />
        <path class="connector connector1" d="M184 77.5C185.933 77.5 187.5 75.933 187.5 74C187.5 72.067 185.933 70.5 184 70.5C182.067 70.5 180.5 72.067 180.5 74C180.5 75.933 182.067 77.5 184 77.5Z" />
        <path class="connector connector1" d="M82.5 96C84.433 96 86 94.433 86 92.5C86 90.567 84.433 89 82.5 89C80.567 89 79 90.567 79 92.5C79 94.433 80.567 96 82.5 96Z" />

        <path class="line line1" d="M162.162 131.527L203.162 145.527" />
        <path class="line line1" d="M129 126.5H54" />
        <path class="line line1" d="M137 112L105 53" />
        <path class="line line1" d="M131 120L86 94" />
        <path class="line line1" d="M142 142L134 175" />
        <path class="line line1" d="M154.604 111.695L181.604 76.6946" />

        <path class="base-outer" d="M146 142.5C155.113 142.5 162.5 135.113 162.5 126C162.5 116.887 155.113 109.5 146 109.5C136.887 109.5 129.5 116.887 129.5 126C129.5 135.113 136.887 142.5 146 142.5Z" />

        <path class="base" d="M146 138C152.627 138 158 132.627 158 126C158 119.373 152.627 114 146 114C139.373 114 134 119.373 134 126C134 132.627 139.373 138 146 138Z" />

        <path
          class="base-logo"
          d="M140 126.244C140 124.252 140.182 122.831 140.547 121.979C140.894 121.164 141.387 120.454 142.027 119.848C142.648 119.259 143.367 118.804 144.183 118.482C145.009 118.161 145.881 118 146.797 118C147.412 118 147.994 118.063 148.547 118.19C148.756 118.238 148.952 118.292 149.135 118.354C149.274 118.402 149.387 118.446 149.474 118.488V121.029C149.277 120.936 149.002 120.856 148.651 120.787C148.141 120.681 147.523 120.629 146.797 120.629C145.592 120.629 144.58 121.008 143.761 121.768C142.931 122.541 142.516 124.034 142.516 126.244C142.516 128.455 142.931 129.945 143.761 130.716C144.58 131.475 145.592 131.855 146.797 131.855C147.523 131.855 148.141 131.804 148.651 131.701C148.856 131.66 149.045 131.611 149.219 131.552C149.35 131.508 149.437 131.475 149.474 131.455V133.996C149.384 134.037 149.271 134.083 149.135 134.135C148.952 134.193 148.756 134.248 148.547 134.299C147.994 134.426 147.412 134.489 146.797 134.489C145.881 134.489 145.009 134.328 144.183 134.006C143.367 133.685 142.648 133.228 142.027 132.636C141.387 132.033 140.894 131.325 140.547 130.51C140.182 129.658 140 128.237 140 126.244Z"
        />
      </g>
    </svg>
  </div>
</template>

<script lang="ts">
import { defineComponent, onMounted } from 'vue';

export default defineComponent({
  name: 'LoaderComponent',
  props: {
    full: {
      type: Boolean,
      default: false,
    },
  },
  setup(props) {
    const lineCount = [1, 2, 3];
    const connectorCount = [1, 2, 3];
    const initDelay = 2700;
    const delay = 1700;

    onMounted(() => {
      if (!props.full) return;

      setTimeout(() => {
        document.querySelector('.base')?.classList.add('base--fill');
        document.querySelector('.base-logo')?.classList.add('base-logo--fill');
      }, initDelay);

      setTimeout(() => {
        document.querySelector('.base-outer')?.classList.add('base-outer--draw');
      }, initDelay + 300);

      lineCount.forEach((x) => {
        setTimeout(() => {
          document.querySelectorAll(`.line${x}`).forEach((line) => line.classList.add('line--draw'));
        }, initDelay + 1300 + (x - 1) * delay);
      });

      connectorCount.forEach((x) => {
        setTimeout(() => {
          document.querySelectorAll(`.connector${x}`).forEach((connector) => connector.classList.add('connector--fill'));
        }, initDelay + 600 + (x - 1) * delay);
      });

      connectorCount.forEach((x) => {
        setTimeout(() => {
          document.querySelectorAll(`.connector${x}`).forEach((connector) => connector.classList.add('connector--draw'));
        }, initDelay + 1800 + (x - 1) * delay);
      });
    });

    return { ...props };
  },
});
</script>

<style scoped type="text/scss" lang="scss">
@use "src/styles/settings/settings.scss";

.loader {
  &__svg {
    display: block;
    width: auto;
    height: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  // Viewbox hack to account for both simple and full animation coming from same svg
  &--simple {
    overflow: hidden;
    margin-top: -200px;
  }
}

.base {
  fill: settings.$color-secondary;
  opacity: 0;
  &--fill {
    opacity: 1;
    transition: opacity 0.3s ease-in;
  }
}

.base-logo {
  fill: settings.$color-primary;
  opacity: 0;
  &--fill {
    opacity: 1;
    transition: opacity 0.3s ease-in;
  }
}

.logo-letter {
  opacity: 1;
  fill: settings.$color-primary;

  $-letterCount: 10;

  @for $letter from 1 through $-letterCount {
    &:nth-child(#{$letter}) {
      animation: hide 0.2s forwards calc(0.2s * #{$letter});
    }
  }
}

.base-outer {
  stroke-dasharray: 300px;
  stroke-dashoffset: 300px;
  stroke-linecap: round;
  stroke: settings.$color-primary;

  &--draw {
    animation: draw 3s linear forwards;
  }
}

.line {
  stroke: settings.$color-primary;
  stroke-dasharray: 300px;
  stroke-dashoffset: 300px;
  stroke-width: 0.5px;
  stroke-linecap: round;
  &--draw {
    animation: draw 2.5s linear forwards;
  }
}

.connector {
  stroke-dasharray: 100px;
  stroke-dashoffset: 100px;
  stroke-linecap: round;
  opacity: 0;
  fill: settings.$color-white;
  stroke: settings.$color-primary;

  &:nth-child(even) {
    stroke-width: 2px;
  }

  &--draw {
    animation: draw 3s linear forwards;
  }

  &--fill {
    opacity: 1;
    transition: opacity 0.3s ease-in;
  }
}

@keyframes draw {
  to {
    stroke-dashoffset: 0;
  }
}

@keyframes hide {
  to {
    opacity: 0;
  }
}
</style>
